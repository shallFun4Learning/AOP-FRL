# AOP-FRL: A Novel Method for Antioxidant Peptides Identification Based on Multi-Feature Representation Learning

## Overview

The **AOP-FRL** algorithm is designed to identify antioxidant peptides using a combination of sequnce and structral features. 
This repository contains the code for training, inference, and dataset preprocessing for this novel method.

We have completed the development and testing locally (Hardware: Tesla V100 GPU, Environment: refer to [Installation](#Installation)). At the same time, we performed code compatibility testing on Google Colab (Using T4 and A100 GPU) and provided a notebook for online execution, which may offer a more streamlined experience, please refer to **[OnlineNotebooks](#OnlineNotebooks)**.


> ⚠️ **Important Notice** 2025.05.05
>
> 
> Unfortunately, our discussions with Microsoft over the E5 Developer Program revocations failed to restore OneDrive access.
> Good news—the project is untouched. The support files is now on [Google Drive](https://drive.google.com/drive/folders/1YS5Yd9D4PgaRHi__cVPKezCIkOnxc8jC?usp=sharing), with [Baidu NetDisk](https://pan.baidu.com/s/1Aknw5fjO2T8fRwpveDzr7w?pwd=1234) still available.
>
> All datasets and pre-trained weight files required for this project can be downloaded from this link.  

> ⚠️ **Important Notice** 2025.04.23
>
> 
> Due to Microsoft's large-scale discontinuation of E5 plans and the deactivation of developer accounts, our OneDrive storage account has been affected. We are currently in contact with Microsoft's support team to resolve this issue.
> 
> As a temporary solution, we are providing an alternative download link via [Baidu Netdisk](https://pan.baidu.com/s/1Aknw5fjO2T8fRwpveDzr7w?pwd=1234).
> 
> All datasets and pre-trained weight files required for this project can be downloaded from this link.
> 
> Depending on the outcome of our discussions with Microsoft, we will either continue using OneDrive or migrate to Google Drive.

## Features

- **Graph Convolutional Network (GCN)** for molecular structure feature extraction.
- **Protein Language Model** for sequence-based feature extraction from peptide sequences.
- **Multi-Feature Fusion**: Combines both sequence and structure information for improved prediction accuracy.
- **Cross-Validation**: Implements 5-fold cross-validation for model evaluation.
- **Evaluation Metrics**: Supports multiple metrics such as accuracy, Matthews correlation coefficient (MCC), AUC, and recall.

## Installation

Ensure that you have Python 3.8.3 installed. You will also need to install the following dependencies:

```bash
pip install torch==1.12.0
pip install transformers==4.32.1 
pip install Accelerate==0.24.1
pip install datasets==2.16.1
pip install rdkit==2024.3.2
pip install torch-geometric==2.3.1
pip install pandas
pip install sklearn
```
Please check the version number carefully, which is our best practice environment. The mismatched version may cause unknown results.
If using GPU, make sure you have the necessary CUDA drivers installed for PyTorch to utilize GPU acceleration.

## Usage
### Preparing the Dataset
The original data set is published in [AnOxPePred](https://github.com/TobiasHeOl/AnOxPePred). 

You can also select the data set we have processed, which can be found here [Google Drive](https://drive.google.com/drive/folders/1nToMqNz2pgPr2ADhUsysbmkibDPqlimr?usp=sharing)|[Baidu Netdisk](https://pan.baidu.com/s/1Aknw5fjO2T8fRwpveDzr7w?pwd=1234).   Then you can skip the data processing step.

Before training or inference, you need a CSV file with peptide sequences and associated labels. Each sequence should be in the sequence column, and labels should be in the label column. Additionally, the SMILES representations for the peptides are also used and can be generated by the script getSMILES.py.

Generating SMILES Representations
To generate SMILES representations for your peptides, run the following script:
```bash
python getSMILES.py
```
This will process the peptide sequences, convert them into SMILES notation, and generate a new CSV with the added SMILES column.

## Training the Model
To train the model, you need to modify the file paths in AOP_FRL_train.py. Specifically, you need to modify the following parameters:

- Data File Path (data_file_path): Set this to the path of your CSV file. The file should contain sequences(and SMILES) and their corresponding labels.

- Model Output Path (out_file_path): Set this to the directory where you want to save the trained model and results.

Modify the following part in the code:

You need to download ESM-2 weights file which could be found here [HuggingFace](https://huggingface.co/facebook/esm2_t30_150M_UR50D/tree/main).

```python
data_file_path = "/path/to/your/data.csv"  # Replace with the path to your data file
esm2_model_path = '/path/to/esm2_model'    # Replace with the path to your ESM-2 model
out_file_path = '/path/to/output_dir'      # Replace with the directory to save the model and results
```
Then, run the following command to start training:
```bash
python AOP_FRL_train.py
```

##  Inference
To make predictions with a trained model, you also need to modify the following paths in AOP_FRL_infer.py:
- Data File Path (data_file_path): Set this to the path of your test data CSV file.
- Model File Path (model_file_path): Set this to the path of the trained model, which is typically the checkpoint directory saved during training.
- Results Path (res_path): Set this to the directory where you want to save the inference results.

Our trained model weights file could be found here [Google Drive](https://drive.google.com/drive/folders/1nToMqNz2pgPr2ADhUsysbmkibDPqlimr?usp=sharing)|[Baidu Netdisk](https://pan.baidu.com/s/1Aknw5fjO2T8fRwpveDzr7w?pwd=1234).

Modify the following part in the code:
```python
data_file_path = "/path/to/your/test_data.csv"  # Path to your test data file
model_file_path = '/path/to/your/trained_model'  # Path to the trained model
res_path = '/path/to/results_output'  # Directory to save the inference results
```
Then, run the following command to perform inference:
```bash
python AOP_FRL_infer.py
```
Inference results will be saved in the specified directory, including predicted labels and scores.

## Evaluation Metrics
The model's performance will automatically be evaluated using the following metrics during training and inference:

- Accuracy (ACC): The proportion of correct predictions.
- Matthews Correlation Coefficient (MCC): A balanced measure of classification performance.
- Recall: True Positive Rate (Sensitivity).
- AUC (Area Under Curve): The area under the ROC curve, measuring the model’s ability to distinguish between classes.

These metrics will be calculated and saved using the Getmetrics.py module after training and inference.

## OnlineNotebooks
We have prepared notebooks that can be run online on Google Colab. The usage instructions are as follows:

🚀 **2025.2.10 Update:**

Due to the default Python version in Google Colab being updated to 3.11, it is no longer possible to directly install the original development environment. Therefore, we have made the following optimizations:
You can **[click here](https://colab.research.google.com/drive/1KJki-l3QtHU3ZPy-KhdB4R-f3U2yLpsU?usp=sharing)** to access or view our online notebook, or copy the link and open it in your browser:[https://colab.research.google.com/drive/1KJki-l3QtHU3ZPy-KhdB4R-f3U2yLpsU?usp=sharing].
- **Enhanced user experience**: The Google Drive method has been deprecated. Now, you can directly use Git to retrieve Python and model files in the notebook.
- **Using CondaColab to manage the environment**: This allows we to start training with the original development environment.

💥**P.S.**: We attempted to test using Google Colab’s V100 and even upgraded to a Pro membership for this purpose. However, as of now, we have not been able to access an available V100 GPU.

## License
This project, AOP-DRL, is licensed under the [Creative Commons Attribution 4.0 International License (CC BY 4.0)](https://creativecommons.org/licenses/by/4.0/).

You are free to use, modify, and distribute this work, provided you give appropriate credit to the original authors.

## Supports
Feel free to submit an issue or contact the author(sfun@foxmail.com) if you encounter any problems during use.

Happy New Year 2025 (is coming~)

:-)
